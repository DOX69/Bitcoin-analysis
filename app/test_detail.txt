
> app@0.1.0 test
> jest src/__tests__/forecast-implementation.test.ts

  console.log
    DATACENTER SERVER LOADED - ENV HOST: SET

      at Object.log (src/lib/bitcoin-data-server.ts:15:9)

FAIL src/__tests__/forecast-implementation.test.ts
  Forecast Implementation Tests
    getForecastData (Server Side)
      Ã— should fetch forecast data and parse it correctly for USD (Default) (14 ms)
      âˆš should convert forecast data to EUR when requested (1 ms)
      âˆš should convert forecast data to CHF when requested (2 ms)
      âˆš should deduplicate forecast data by date (2 ms)
    convertPrice Utility
      âˆš should return USD price as is (1 ms)
      âˆš should convert to CHF
      âˆš should convert to EUR
    getForecastSlice (Client Side)
      âˆš should return 7 days for 1w filter
      âˆš should return 30 days for 1m filter (1 ms)
      âˆš should return 180 days for 6m filter (1 ms)
      âˆš should return 365 days for 1y and ytd filter (1 ms)
      âˆš should aggregate data monthly for ALL filter (3 ms)
      âˆš should return empty array if input is empty (1 ms)

  â— Forecast Implementation Tests â€º getForecastData (Server Side) â€º should fetch forecast data and parse it correctly for USD (Default)

    expect(received).toBe(expected) // Object.is equality

    Expected: 365
    Received: 364

    [0m [90m 54 |[39m             [90m// Verify query execution (cannot easily verify LIMIT in SQL string here without strict string matching)[39m
     [90m 55 |[39m             expect(executeQuery)[33m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 56 |[39m             expect(result[33m.[39mlength)[33m.[39mtoBe([35m365[39m)[33m;[39m
     [90m    |[39m                                   [31m[1m^[22m[39m
     [90m 57 |[39m             expect(result[[35m0[39m][33m.[39mpredicted_close_usd)[33m.[39mtoBe([35m50000[39m)[33m;[39m
     [90m 58 |[39m         })[33m;[39m
     [90m 59 |[39m[0m

      at Object.toBe (src/__tests__/forecast-implementation.test.ts:56:35)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 12 passed, 13 total
Snapshots:   0 total
Time:        1.542 s
Ran all test suites matching src/__tests__/forecast-implementation.test.ts.
